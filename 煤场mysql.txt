SELECT
	tu.cUserName as username ,
	tu.mobile as phone,
	tr.cDspName as userrole
	tc.cCustomerName as customername,
	td.DeptName as department,
  tu.memo as remark  
FROM
	t_user tu
	INNER JOIN t_userrole tr ON tu.iPopedom = tr.iPopedom
	INNER JOIN t_customer tc ON tu.iCustomerID = tc.iCustomerID
	INNER JOIN t_dept td ON td.iDeptID = tu.iDeptID
	WHERE tu.cUserName='kf'


查询用户用户信息

  SELECT
    tu.cUserName as username ,
    tu.mobile as phone,
    tr.cDspName as userrole,
    tc.cCustomerName as customername,
    td.DeptName as department,
    tu.memo as remark
    FROM
    t_user tu
    INNER JOIN t_userrole tr ON tu.iPopedom = tr.iPopedom
    INNER JOIN t_customer tc ON tu.iCustomerID = tc.iCustomerID
    INNER JOIN t_dept td ON td.iDeptID = tu.iDeptID
    WHERE 1=1
    <if test="cusername!=null">
     and tu.cUserName=#{cusername,jdbcType=VARCHAR}</if>   

删除所有客户信息


delete from t_user
    where ID = 31




<客户查询>

SELECT * from t_customer

<部门查询>

SELECT * from t_dept


<操作日志查询>

SELECT
	tu.cUserName AS userName,
	top.operationDate AS operationdate
	top.tAction AS taction,
	top.tUrl AS turl,
	top.`status` AS `status` 
FROM
	t_operation_log top
	INNER JOIN t_user tu ON top.operationUserID = tu.iUserID


--------------------------------------------------------------------------------------------
SELECT
	tu.cUserName AS userName,
	top.operationDate AS operationdate,
	top.tAction AS taction,
	top.tUrl AS turl,
	top.`status` AS `status` 
FROM
	t_operation_log top
	INNER JOIN t_user tu ON top.operationUserID = tu.iUserID


------------------------------------------------------------------------------------------------
查询日志记录
SELECT
	tu.cUserName AS username,
	top.operationDate AS operationdate,
	top.tUrlName AS turlname,
	top.`status` AS `status` 
FROM
	t_operation_log top
	INNER JOIN t_user tu ON tu.iUserID = top.operationUserID 
WHERE
	1 = 1 
	AND top.operationDate BETWEEN '2019-12-11 16:31:30' 
	AND '2019-12-11 16:31:35' 
	AND tu.cUserName = 'erw'

查询监测点设备状态
SELECT
	td.`name`,
	td.`status`,
	td.site,
	tdt.`name` AS dtname,
	tc.cCustomerName 
FROM
	t_dev td
	INNER JOIN t_dev_type tdt ON td.type = tdt.id
	INNER JOIN t_customer tc ON td.customer = tc.iCustomerID 
WHERE
	td.id =3

查询最新温度
 select
        dCollectDT,fT,dev_id
        from t_temperature
        where 1=1
        <if test="devid!=null">
            AND dev_id = #{devid,jdbcType=INTEGER}
        </if>
        order by dCollectDT limit 1

查询一小时或是一天内的温度曲线

SELECT
	dCollectDT,
	fT 
FROM
	t_temperature
WHERE
	1 = 1 
	AND devID = 3 
	AND dCollectDT BETWEEN '2019-12-11 00:00:05' AND '2019-12-12 23:00:05'





查询历史温度曲线
SELECT
	dCollectDT,
	fT 
FROM
	t_temperature_history 
WHERE
	1 = 1 
	AND devID = 3 
	AND dCollectDT BETWEEN '2019-12-11 00:00:05' AND '2019-12-12 23:00:05'

查询预警参数 ---温度等
SELECT
	cParam,
	cValue 
FROM
	t_parameter 
WHERE
	1 = 1 
	AND iCustomerID = 2

查询最新的气体数据
SELECT
	* 
FROM
	t_gas 
WHERE
	1 = 1 
	AND dev_id = 3 
ORDER BY
	dCollectDT DESC 
	LIMIT 1

-------------------------------
查询一日内温度曲线
SELECT
	DATE_FORMAT( dCollectDT, '%Y-%m-%d %H:00:00' ) as dCollectDT,
	AVG( fT ) AS fT,
	dev_id AS devid 
FROM
	t_temperature_history 
WHERE
	1 = 1 
	AND dev_id = 3 
	AND dCollectDT BETWEEN '2019-12-17 00:00:00' 
	AND '2019-12-17 23:59:59' 
GROUP BY
	DATE_FORMAT( dCollectDT, '%Y-%m-%d %H' ) 
ORDER BY
	id ASC 



查询一日内气体曲线






查询所有设备可燃气体
待定

SELECT
	DATE_FORMAT( dCollectDT, '%Y-%m-%d %H:00:00' ) as dCollectDT,
	AVG( gCH4 ) AS gCH4,
	AVG( gCO ) AS gCO,
	AVG( gO2 ) AS gO2,
	dev_id AS devid 
FROM
	t_gas_history 
WHERE
	1 = 1 
	AND dev_id = 3 
	AND dCollectDT BETWEEN '2019-12-17 00:00:00' 
	AND '2019-12-17 23:59:59' 
GROUP BY
	DATE_FORMAT( dCollectDT, '%Y-%m-%d %H' ) 
ORDER BY
	id ASC 





获取最新粉尘数据
SELECT
	* 
FROM
	t_dust 
WHERE
	1 = 1 
	AND dev_id = 3 
ORDER BY
	dCollectDT DESC 
	LIMIT 1


一天粉尘数据


SELECT
	DATE_FORMAT( dCollectDT, '%Y-%m-%d %H:00:00' ) as dCollectDT,
	fDust AS fdust,
	dev_id AS devid 
FROM
	t_dust_history
WHERE
	1 = 1 
	AND dev_id = 3 
	AND dCollectDT BETWEEN '2019-12-17 00:00:00' 
	AND '2019-12-17 23:59:59' 
GROUP BY
	DATE_FORMAT( dCollectDT, '%Y-%m-%d %H' ) 
ORDER BY
	id ASC 




SELECT
	DATE_FORMAT( dCollectDT, '%Y-%m-%d %H:00:00' ) as dCollectDT,
	fDust AS fdust,
	dev_id AS devid 
FROM
	t_dust_history
WHERE
	1 = 1 
	AND dev_id = 3 
	AND dCollectDT BETWEEN '2019-12-17 00:00:00' 
	AND '2019-12-17 23:59:59' 
GROUP BY
	DATE_FORMAT( dCollectDT, '%Y-%m-%d %H' ) 
ORDER BY
	id ASC 
	
SELECT
	dCollectDT,
	fDust AS fdust,
	dev_id AS devid 
FROM
	t_dust_history 
WHERE
	1 = 1 
	AND dev_id = 3
	ORDER BY dCollectDT DESC 
	LIMIT 1



获取最新水压水流信息

SELECT
	* 
FROM
	t_press_flow
WHERE
	1 = 1 
	AND dev_id = 3 
ORDER BY
	dCollectDT DESC 
	LIMIT 1
-------温度检测列表-----
               SELECT DISTINCT
	* 
FROM
	(
	SELECT
		tdt.`name` AS typename,
		td.`name` AS NAME,
		td.ip AS ip,
		td.`status` AS `status`,
		tt.fT AS ft 
	FROM
		t_dev td
		INNER JOIN t_dev_type tdt ON td.type = tdt.id
		INNER JOIN t_temperature tt ON td.id = tt.dev_id 
	WHERE
		td.`status` = 0 
		AND td.`name` LIKE '%温度探测器%' 
	) a


-----查询气体设备监控列表------
SELECT DISTINCT
	* 
FROM
	(
	SELECT
		tdt.`name` AS typename,
		td.`name` AS devname,
		td.site AS site,
		td.ip AS ip,
		td.`status` AS `status`,
		td.update_time AS updatetime,
		tg.gCH4 AS gch4,
		tg.gCO AS gCO,
		tg.gO2 AS gO2 
	FROM
		t_dev td
		INNER JOIN t_dev_type tdt ON td.type = tdt.id
		INNER JOIN t_gas tg ON td.id = tg.dev_id 
	WHERE
		td.type = 3 
	) a
	


-----查询烟尘检测列表----
SELECT DISTINCT
	* 
FROM
	(
	SELECT
		tdt.`name` AS typename,
		td.`name` AS NAME,
		td.ip AS ip,
		td.`status` AS `status`,
		tdu.fDust AS fDust
		FROM
		t_dev td
		INNER JOIN t_dev_type tdt ON td.type = tdt.id
		INNER JOIN t_dust tdu ON td.id = tdu.dev_id 
	WHERE
		td.`status` = 0 
	AND td.`name` LIKE '%探测器%' 
	) a


获取水压监控列表








